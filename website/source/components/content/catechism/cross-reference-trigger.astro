---
import { Language, NumberOrNumberRange } from '@catechism-types';

import PartialTrigger from '@components/partial-trigger.astro';

import { path } from '@logic/navigation-utils';

interface Props {
    reference: NumberOrNumberRange;
    language: Language;
    hasProceedingTrigger: boolean;
}

const { reference, language, hasProceedingTrigger } = Astro.props;

const referenceForUrl = reference.toString().replace('â€“', '-');
const contentUrl = path('/partials/cross-reference', language, referenceForUrl);

const separator = hasProceedingTrigger ? ', ' : '';
---

<script>
    import { defineElement } from '@logic/custom-elements';
    import { onClick } from '@logic/dom-utils';
    import { $crossReferenceDrawerIsOpen } from '@logic/state/cross-reference-drawer';

    class CrossReferenceTrigger extends HTMLElement {
        constructor() {
            super();
        }

        connectedCallback() {
            onClick(this, () => $crossReferenceDrawerIsOpen.set(true));
        }
    }

    defineElement('cross-reference-trigger', CrossReferenceTrigger);
</script>

<cross-reference-trigger>
    <PartialTrigger {contentUrl} class="cursor-pointer text">
        {reference.toString()}{separator}
    </PartialTrigger>
</cross-reference-trigger>
